# PHP версия проекта "Русский Крест"

Это PHP версия веб-сайта благотворительного фонда "Русский Крест" с интеграцией базы данных Supabase.

## Структура проекта

### PHP файлы

- **config.php** - Конфигурация подключения к Supabase и вспомогательные функции
- **index.php** - Главная страница с разделом новостей
- **news.php** - Страница со списком всех новостей с фильтрацией
- **article.php** - Страница отдельной статьи

### Основные функции (config.php)

#### supabaseRequest($endpoint, $method, $data)
Выполняет HTTP запрос к Supabase REST API

#### getNewsList($category, $limit, $offset, $featured)
Получает список новостей из базы данных
- `$category` - фильтр по категории (news, media, events)
- `$limit` - количество записей
- `$offset` - смещение для пагинации
- `$featured` - только избранные новости

#### getNewsArticle($slug)
Получает одну статью по slug

#### formatDate($dateString)
Форматирует дату в русский формат "день месяц год г."

#### getCategoryName($category)
Возвращает русское название категории

#### escapeHtml($text)
Экранирует HTML для безопасного вывода

## Требования

- PHP 7.4 или выше
- Расширение cURL
- Доступ к Supabase базе данных

## Настройка

1. Убедитесь, что файл `.env` содержит правильные данные для подключения к Supabase:
   ```
   VITE_SUPABASE_URL=https://your-project.supabase.co
   VITE_SUPABASE_ANON_KEY=your-anon-key
   ```

2. Настройте веб-сервер (Apache/Nginx) для обслуживания PHP файлов

3. Убедитесь, что в базе данных Supabase есть таблица `news_articles` со следующими полями:
   - id
   - title
   - slug
   - excerpt
   - content
   - image_url
   - category
   - published_at
   - is_featured

## Использование

### Главная страница
```
http://your-domain/index.php
```
Отображает последние 5 новостей

### Страница новостей
```
http://your-domain/news.php
http://your-domain/news.php?category=news
http://your-domain/news.php?category=media
http://your-domain/news.php?category=events
```
Отображает список новостей с возможностью фильтрации по категориям

### Страница статьи
```
http://your-domain/article.php?slug=article-slug
```
Отображает полную статью

## Безопасность

- Все данные, выводимые на страницу, экранируются через функцию `escapeHtml()`
- Параметры URL проверяются и очищаются
- Используется подготовленная структура запросов к API

## Стили и ресурсы

Проект использует существующие стили из `/styles/main.css` и изображения из папки `/img/`

## Отличия от JavaScript версии

1. Данные загружаются на сервере при генерации страницы
2. Нет необходимости в JavaScript для основной функциональности
3. Пагинация работает через URL параметры
4. Лучшая SEO оптимизация за счет серверного рендеринга

## Расширение функциональности

Для добавления новых функций:

1. Добавьте необходимые функции в `config.php`
2. Создайте новый PHP файл или расширьте существующий
3. Используйте функцию `supabaseRequest()` для запросов к базе данных
4. Всегда используйте `escapeHtml()` для вывода пользовательских данных
